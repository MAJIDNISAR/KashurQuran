"use strict";!function(a){var b={Constants:{CUSTOM_SCROLLBAR_ALWAYS_VISIBLE:!0,CUSTOM_SCROLLBAR_DISTANCE:"4px",CUSTOM_SCROLLBAR_HEIGHT:"100%",CUSTOM_SCROLLBAR_POSITION:"right",CUSTOM_SCROLLBAR_SIZE:"7px",CUSTOM_SCROLLBAR_START:"bottom",CUSTOM_SCROLLBAR_WIDTH:"100%",MEDIA_QUERY_BREAKPOINT:"992px"},CssClasses:{LAYOUT:"layout",LAYOUT_HEADER:"layout-header",MESSENGER_LIST:"messenger-list",MESSENGER_LIST_ITEM:"messenger-list-item",MESSENGER_LIST_LINK:"messenger-list-link",MESSENGER_CONTENT:"messenger-content",MESSENGER_SCROLLABLE_CONTENT:"messenger-scrollable-content",CUSTOM_SCROLLBAR:"messenger-scrollbar",CUSTOM_SCROLLBAR_BAR:"messenger-scrollbar-gripper",CUSTOM_SCROLLBAR_RAIL:"messenger-scrollbar-track",CUSTOM_SCROLLBAR_WRAPPER:"messenger-scrollable-area",ACTIVE:"active",HOVER:"hover"},KeyCodes:{OPEN_SQUARE_BRACKET:219,CLOSE_SQUARE_BRACKET:221},init:function(){this.$window=a(window),this.$offset=a("."+this.CssClasses.LAYOUT_HEADER),this.$list=a("."+this.CssClasses.MESSENGER_LIST),this.$items=a("."+this.CssClasses.MESSENGER_LIST_ITEM),this.$links=a("."+this.CssClasses.MESSENGER_LIST_LINK),this.$content=a("."+this.CssClasses.MESSENGER_CONTENT),this.$backBtns=this.$content.find('[data-toggle="tab"]'),this.breakpoint=null,this.bindEvents()},bindEvents:function(){this.$items.on("mouseenter.e.messenger",this.handleItemMouseEnter.bind(this)),this.$items.on("mouseleave.e.messenger",this.handleItemMouseLeave.bind(this)),this.$links.on("click.e.messenger",this.handleLinkClick.bind(this)),this.$window.on("resize.e.messenger",this.handleWindowResize.bind(this)),this.$links.add(this.$backBtns).on("shown.bs.tab",this.handleTabShown.bind(this)).on("hidden.bs.tab",this.handleTabHidden.bind(this)),this.breakpoint=window.matchMedia("(max-width: "+this.Constants.MEDIA_QUERY_BREAKPOINT+")"),this.breakpoint.addListener(this.handleMediaQueryChange.bind(this))},handleItemMouseEnter:function(b){a(b.currentTarget).addClass(this.CssClasses.HOVER)},handleItemMouseLeave:function(b){a(b.currentTarget).removeClass(this.CssClasses.HOVER)},handleLinkClick:function(b){var c=a(b.currentTarget),d=c.closest("."+this.CssClasses.MESSENGER_LIST_ITEM);d.hasClass(this.CssClasses.ACTIVE)&&d.removeClass(this.CssClasses.ACTIVE),this.rememberScrollbarPos()},handleWindowResize:function(a){this.adjustActiveConversation(),this.updateCustomScrollBar()},handleTabShown:function(b){var c=a(b.currentTarget),d=this.getActiveLink();if(c.is(d)){var e=this.getScrollableArea();this.adjustActiveConversation(),this.addCustomScrollbarTo(e)}else this.scrollTo(this.rememberedScrollbarPos())},handleTabHidden:function(b){var c=a(b.currentTarget),d=a(c.attr("href")),e=d.find("."+this.CssClasses.MESSENGER_SCROLLABLE_CONTENT);d.removeAttr("style"),this.removeCustomScrollbarFrom(e)},handleMediaQueryChange:function(a){var b=this[this.mediaQueryMatches()?"getBackBtn":"getActiveLink"]();b.length&&b.trigger("click"),this.resetActiveConversation()},mediaQueryMatches:function(){return this.breakpoint.matches},rememberScrollbarPos:function(){this.ypos=this.$window.scrollTop()},rememberedScrollbarPos:function(){return this.ypos},getActiveItem:function(){return this.$items.filter("."+this.CssClasses.ACTIVE)},getActiveConversation:function(){return this.$content.filter("."+this.CssClasses.ACTIVE)},getActiveLink:function(){var a=this.getActiveItem();return a.find('[data-toggle="tab"]')},getBackBtn:function(){var a=this.getActiveConversation();return a.find('[data-toggle="tab"]')},getScrollableArea:function(){var a=this.getActiveConversation();return a.find("."+this.CssClasses.MESSENGER_SCROLLABLE_CONTENT)},adjustActiveConversation:function(){var a=this.getActiveConversation();this.mediaQueryMatches()&&a.length&&a.height(this.calculateTabHeight())},resetActiveConversation:function(){var a=this.getActiveConversation();a.length&&a.removeAttr("style")},addCustomScrollbarTo:function(a){a.slimScroll(this.getCustomScrollbarOptions())},updateCustomScrollBar:function(){var a=this.getScrollableArea(),b=this.getCustomScrollbarOptions();a.slimScroll(b)},removeCustomScrollbarFrom:function(a){var b=this.getCustomScrollbarOptions();b.destroy=!0,a.slimScroll(b).off().removeAttr("style")},scrollTo:function(a){this.$window.scrollTop(a)},calculateTabHeight:function(){var a=this.$window.height(),b=this.$offset.height();return a-b},getCreateOptions:function(b,c){var d=new RegExp("^"+b+"(_)?","i"),e={};return a.each(this,function(b,f){a.isPlainObject(f)&&a.each(f,function(f,g){d.test(f)&&(f=f.replace(d,"").replace(/_/g,"-"),f=a.camelCase(f.toLowerCase()),c&&c(e,b,f,g)||(e[f]=g))})}),e},getCustomScrollbarOptions:function(){return this.getCreateOptions("custom_scrollbar",function(a,b,c,d){return c="CssClasses"===b?c+"Class":c,a[c]=d})}};b.init()}(jQuery);